---
layout: post
title: "Laravel"
description: 
headline: 
modified: 2022-03-02
category: webdevelopment
imagefeature: cover3.jpg
tags: [Laravel]
mathjax: 
chart: 
share: true
comments: true
featured: true
disqus:
---

# Record

## 목차
- [](#)

## 개념
- 

## 특징
- 모델-뷰-컨트롤러(MODEL-VIEW-CONTROLLER) 아키텍쳐 패턴 지원
- 객체지향(OBJECT-ORIENTED) 라이브러리
- 명령 줄 인터페이스(COMMAND-LINE INTERFACE)
- 라라벨의 템플릿 엔진
- 효율적인 ORM과 데이터베이스 관리
- 효과적인 단위 테스트를 위한 적절한 지원.
- 라라벨은 100% 오픈소스이다.


## 설치
- npm
- yarn
- /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
- brew update
- composer
```JavaScript
    php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
    php -r "if (hash_file('sha384', 'composer-setup.php') === '906a84df04cea2aa72f40b5f787e49f22d4c2f19492ac310e8cba5b96ac8b64115ac402c8cd292b8a03482574915d1a8') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
    php composer-setup.php
    php -r "unlink('composer-setup.php');"
```
- sudo mv composer.phar /usr/local/bin/composer
- composer global require laravel/installer

## 시작
- laravel new blog
- composer create-project --prefer-dist laravel/laravel blog2
- php artisan serve

## artisan
- artisan 명령어
- artisan 은 라라벨에 내장된 명령행 방식의 통합 유틸리티로 루비온레일의 rails 콘솔처럼 라라벨로 프로젝트를 진행하기 위해서는 꼭 알아야 할 필수 요소로 다음과 같은 작업을 할 수 있습니다.

    - 라라벨 애플리케이션의 구성(라우팅,  캐시, 환경값)을 검사하고 설정 변경
    - 애플리케이션을 정비/운영 모드로 전환 
    - 라라벨 개발에 필요한 여러 가지 타입(컨트롤러, 리스너, 모델, 미들웨어등) 생성
    - 라라벨 성능에 영향을 주는 여러 가지 설정 변경
    - 대화형으로 라라벨 애플리케이션 프로토타이핑 및 디버깅

### artisan migrate
- 테이블 변경사항 공유
```JavaScript
    php artisan migrate
```

    - up 메소드는 데이터베이스에 테이블, 컬럼, 인덱스를 추가하는데 사용되고
    - down 메소드는 up 메소드의 동작을 취소합니다.

- 마이그레이션 파일 생성
```JavaScript
    php artisan make:migration create_users_table
```

- 마이그레이션 되돌리기
```JavaScript
    php artisan migrate:rollback
    php artisan migrate:rollback --step=5   //최근 5개의 마이그레이션만 되돌립니다:
    php artisan migrate:reset  //모든 마이그레이션 되돌리기
```

- 마이그레이션 명령어
    - [https://laravel.kr/docs/5.7/migrations](https://laravel.kr/docs/5.7/migrations)

    - 테이블 생성하기
    ```JavaScript
    Schema::create('users', function (Blueprint $table) {
        $table->increments('id');
    });
    ```

    - 테이블 / 컬럼이 존재하는지 확인하기
    ```JavaScript
    if (Schema::hasTable('users')) {
        //
    }

    if (Schema::hasColumn('users', 'email')) {
        //
    }
    ```

    - 데이터베이스 커넥션-connection & 테이블 옵션
    ```JavaScript
    Schema::connection('foo')->create('users', function (Blueprint $table) {
        $table->increments('id');
    });
    ```

    - 테이블 이름 변경 / 제거하기
    ```JavaScript
    Schema::rename($from, $to);

    Schema::drop('users');

    Schema::dropIfExists('users');
    ```

    - 컬럼 생성하기
    ```JavaScript
    Schema::table('users', function (Blueprint $table) {
        $table->string('email');
    });
    ```

    - 컬럼 Modifiers
    ```JavaScript
    Schema::table('users', function (Blueprint $table) {
        $table->string('email')->nullable();
    });
    ```

    * 사전 준비사항
    - 컬럼을 수정하기 전에, 꼭 composer.json 파일에 doctrine/dbal 의존성을 추가하십시오. Doctrine DBAL 라이브러리는 컬럼의 현재 상태를 확인하고 필요한 SQL 쿼리를 생성하여 컬럼에 지정된 변경사항을 수행하기 위해 사용됩니다:
    ```JavaScript
    composer require doctrine/dbal
    ```

    - 컬럼의 속성 변경하기
    ```JavaScript
    Schema::table('users', function (Blueprint $table) {
        $table->string('name', 50)->change();
    });
    컬럼을 nullable로 수정할 수도 있습니다:

    Schema::table('users', function (Blueprint $table) {
        $table->string('name', 50)->nullable()->change();
    });
    ```

    - 컬럼의 이름 변경하기
    ```JavaScript
    Schema::table('users', function (Blueprint $table) {
        $table->renameColumn('from', 'to');
    });
    ```

    - 컬럼 삭제하기
    ```JavaScript
    Schema::table('users', function (Blueprint $table) {
        $table->dropColumn('votes');
    });
    dropColumn 메소드에 컬럼 이름들의 배열을 전달하면 테이블에서 여러 개의 컬럼을 없앨 수 있습니다:

    Schema::table('users', function (Blueprint $table) {
        $table->dropColumn(['votes', 'avatar', 'location']);
    });
    ```

    - 인덱스 생성하기
    ```JavaScript
    $table->string('email')->unique();
    위와 같이 하는 대신에, 컬럼을 정의한 뒤에 인덱스를 생성할 수도 있습니다. 예를 들어:

    $table->unique('email');
    인덱스 메소드에 컬럼의 배열을 전달하여 복합 인덱스를 생성할 수도 있습니다:

    $table->index(['account_id', 'created_at']);
    라라벨은 자동으로 알맞은 인덱스 이름을 생성할 것입니다만, 메소드의 두번째 인자로 인덱스 이름을 지정할 수도 있습니다:

    $table->unique('email', 'unique_email');
    ```

    - 인덱스 이름 변경하기
    ```JavaScript
    $table->renameIndex('from', 'to')
    ```

    - 인덱스 삭제하기
    ```JavaScript
    Schema::table('geo', function (Blueprint $table) {
        $table->dropIndex(['state']); // Drops index 'geo_state_index'
    });
    ```

    - 외래키 제한
    ```JavaScript
    라라벨은 데이터베이스에서 또한 참조 무결성을 강제하는 외래 키 제한을 생성하는 것을 제공합니다. 예를 들어 users 테이블의 id 컬럼을 참조하는 posts 테이블에 user_id 컬럼을 정의해보겠습니다:

    Schema::table('posts', function (Blueprint $table) {
        $table->unsignedInteger('user_id');

        $table->foreign('user_id')->references('id')->on('users');
    });
    제한(constraint)의 "on delete"와 "on update" 속성에 원하는 동작을 지정할 수도 있습니다:

    $table->foreign('user_id')
        ->references('id')->on('users')
        ->onDelete('cascade');
    외래 키를 지우기 위해서는 dropForeign 메소드를 사용할 수 있습니다. 외래 키 제한은 인덱스와 같은 명명 규칙을 사용합니다. 따라서 테이블 이름과 제한(constraint)의 컬럼들을 합치고 뒤에 "_foreign"을 붙일 것입니다:

    $table->dropForeign('posts_user_id_foreign');
    또는 배열 값을 전달하면 삭제시 자동으로 컨벤션 규칙에 따르는 이름이 사용됩니다:

    $table->dropForeign(['user_id']);
    마이그레이션에서 다음의 메소드들을 사용하여 외래키 제약을 활성/비활성 할 수 있습니다:

    Schema::enableForeignKeyConstraints();

    Schema::disableForeignKeyConstraints();
    ```


### artisan db:seed
- 라라벨에서는 시드(seed) 클래스를 사용해서 테스트 데이터를 데이터베이스에 설정하는 간단한 메소드를 포함하고 있습니다. 



## Assets 변경 감시하기
- npm run watch 명령어는 터미널에서 계속 실행되면서 모든 관련된 파일의 변경사항을 감시합니다. Webpack은 변경사항이 감지되면 자동으로 이를 다시 컴파일 합니다:
```JavaScript
    npm run watch
```

- 구동환경에 따라서 파일의 변경사항을 발생해도 Webpack이 업데이트 되지 않게 할 수도 있습니다. 사용하는 시스템이 이 경우라면, watch-poll 명령어 사용을 고려하십시오:
```JavaScript
    npm run watch-poll
```

## PEAR, PECL
```JavaScript
PHP Extension and Application Repository; PEAR
PHP 익스텐션 및 애플리케이션 저장소; 피어
/usr/bin/pear
PHP Extension Community Library; PECL
PHP 확장모듈 커뮤니티 라이브러리; 피클
/usr/bin/pecl
```

- PEAR
    - PHP 확장모듈 프레임워크 및 배포 시스템
    - 되도록이면 이것 대신 composer 사용을 권장함[1]

```JavaScript
[root@zetawiki ~]# cat /usr/bin/pear
#!/bin/sh
exec /usr/bin/php -C -d include_path=/usr/share/pear \
    -d output_buffering=1 /usr/share/pear/pearcmd.php "$@"
```

- PECL
    - PHP 확장모듈 저장소
    - 자매 저장소 PEAR와 공유됨
Peclsmall.gif
2.1 기본값
pecl은 알고 보면 리눅스쉘에서 peclcmd.php를 돌리는 스크립트이다.

```JavaScript
[root@zetawiki ~]# cat /usr/bin/pecl
#!/bin/sh
exec /usr/bin/php -C -n -q -d include_path=/usr/share/pear \
    -d output_buffering=1 /usr/share/pear/peclcmd.php "$@"
```

- 설치, 확인
```JavaScript
pear version
pecl version
apt-get install php-pear
```